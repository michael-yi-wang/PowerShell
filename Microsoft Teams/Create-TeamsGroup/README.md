# Create-TeamsGroup PowerShell Script

This PowerShell script automates the creation of Microsoft Teams groups using the Microsoft Graph API. It takes a CSV file as input containing team names and owner information, creates the teams, and optionally returns the email addresses for the default "General" channel of each newly created team.

## Prerequisites

- PowerShell 5.1 or higher
- Microsoft Graph PowerShell SDK

  ```powershell
  Install-Module Microsoft.Graph -Scope CurrentUser
  ```
  
- Required permissions:
  - Group.ReadWrite.All
  - User.Read.All
- Valid CSV file with team information

## CSV File Format

The input CSV file must contain the following columns:

```csv
TeamName,OwnerUPN
"Marketing Team","owner1@contoso.com"
"Sales Team","owner2@contoso.com"
```

- `TeamName`: The display name for the team
- `OwnerUPN`: The User Principal Name (email) of the team owner

## Parameters

- `-CsvPath` (Mandatory)
  - Type: String
  - Description: Path to the CSV file containing team information
  
- `-ReturnTeamsEmail` (Optional)
  - Type: Boolean
  - Default: $false
  - Description: When set to $true, returns the email address for the "General" channel of each newly created team

## Usage Examples

1. Create teams without returning email addresses:

```powershell
.\Create-TeamsGroup.ps1 -CsvPath ".\teams.csv"
```

1. Create teams and get the general channel email addresses:

```powershell
.\Create-TeamsGroup.ps1 -CsvPath ".\teams.csv" -ReturnTeamsEmail $true
```

## Output

The script returns a table with the following information for each team:

- TeamName: The name of the team
- Status: Creation status (success or failure message)
- TeamId: The unique identifier for the created team
- GeneralChannelEmail: (If ReturnTeamsEmail is $true) The email address for the General channel

## Error Handling

The script includes comprehensive error handling for:

- Missing or invalid CSV file
- Incorrect CSV structure
- Failed team creation
- Owner not found
- Connection issues

## Notes

- The script automatically creates a Mail-Enabled Security Group with Teams functionality
- Teams are created as private by default
- The script will skip teams that fail to create and continue with the remaining entries
- Mail nicknames are automatically generated by removing special characters from the team name

## Requirements

- Active Microsoft 365 subscription with Teams license
- Account with sufficient permissions to create teams and assign owners
- Internet connectivity to access Microsoft Graph API

## Security Note

The script uses modern authentication through Microsoft Graph API. No credentials are stored in the script.
